var OMathContent=(()=>{var u=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var w=(i,e)=>{for(var t in e)u(i,t,{get:e[t],enumerable:!0})},M=(i,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of A(e))!E.call(i,r)&&r!==t&&u(i,r,{get:()=>e[r],enumerable:!(n=y(e,r))||n.enumerable});return i};var S=i=>M(u({},"__esModule",{value:!0}),i);var x={};w(x,{initProducts:()=>m});function h(i){L(i),v(i)}function L(i){i.querySelectorAll('figure[data-type="image"]').forEach(e=>I(e))}function I(i){let e=250,t={wheelToZoom:!0,bgOpacity:.9,showAnimationDuration:e,hideAnimationDuration:e},n=new PhotoSwipeLightbox({gallery:i,children:"a[data-pswp-single]",pswpModule:PhotoSwipe,...t,...globalThis.PhotoSwipeLang??{}});n.on("contentAppend",function(a){n.pswp.currSlide.data.element.querySelector("img").hasAttribute("data-invertible")&&a.content.element.setAttribute("data-invertible","")});let r=new PhotoSwipeDynamicCaption(n,{type:"below",captionContent:a=>{let s=a.data.element.closest("figure").querySelector("figcaption");return s?s.innerHTML:""},mobileLayoutBreakpoint:()=>!0});n.init()}function v(i){let e=i.querySelectorAll('figure[data-type="video"]'),t={},n={rootMargin:"0px 0px 75px 0px",threshold:0},r=s=>{s.forEach(d=>{let l=d.target,o=l.closest("figure").getAttribute("data-uuid");if(d.isIntersecting){if(t[o]==="new"||t[o]==="inFlow")try{l.play()}catch{}}else l.paused?t[o]!=="new"&&(t[o]="outFlow"):(l.pause(),t[o]="inFlow")})},a=new IntersectionObserver(r,n);e.forEach(s=>{t[s.getAttribute("data-uuid")]="new",a.observe(s.querySelector("video"))})}function f(i){i.querySelectorAll(".accentBlock").forEach(e=>{let t=e.querySelector(":scope > .side > .expand");t&&t.addEventListener("click",()=>e.toggleAttribute("data-expand-open"))})}var p=class{selectorImages;displayImages;constructor(e){this.selectorImages=e.querySelectorAll(":scope > .selector > .inner > .image"),this.displayImages=e.querySelectorAll(":scope > .display > .displayImage"),this.selectorImages.forEach((r,a)=>r.addEventListener("click",()=>{this.selectorImages.forEach(s=>s.removeAttribute("data-current")),r.setAttribute("data-current",""),this.displayImages.forEach(s=>s.removeAttribute("data-current")),this.displayImages[a].setAttribute("data-current","")}));let t=parseFloat(e.getAttribute("data-start"))-1;t<0&&(t=0),t>this.selectorImages.length-1&&(t=this.selectorImages.length-1);let n=this.selectorImages[t];n&&n.click()}};function b(i){i.querySelectorAll(".gallery").forEach(e=>new p(e))}function k(i){i.querySelectorAll("a.link").forEach(e=>{let t,n=!1;e.addEventListener("click",r=>{n||!e.hasAttribute("data-preview")||(r.preventDefault(),clearTimeout(t),n=!0,t=setTimeout(()=>{n=!1},300),OMathEvent.onLinkClick(e,r))})})}function T(i){i.querySelectorAll(".task").forEach(e=>{e.querySelectorAll(":scope > header > .controls > button").forEach(t=>{t.addEventListener("click",()=>{if(t.classList.contains("generate")){globalThis.GenTaskManager.genTask(e);return}t.getAttribute("data-section")==="similar"&&!e.hasAttribute("data-similar-open")&&(e.hasAttribute("data-tasks-generated")||(e.setAttribute("data-tasks-generated",""),e.parentElement.querySelectorAll(":scope > .similarTasks .task.genTask").forEach(n=>globalThis.GenTaskManager.genTask(n)))),e.toggleAttribute(`data-${t.getAttribute("data-section")}-open`)})})})}var g=class{elements;constructor(e){this.elements={},this.elements.task=e,this.elements.statement=e.querySelector(":scope > .statement"),this.elements.sections={},e.querySelectorAll("section").forEach(t=>{this.elements.sections[t.getAttribute("data-name")]=t})}get statement(){return this.elements.statement.innerHTML}set statement(e){this.elements.statement.innerHTML=e}getSectionNames(){return Object.keys(this.elements.sections)}getSectionContent(e){let t=this.elements.sections[e];return t?t.querySelector(":scope > .inner > .content").innerHTML:null}setSectionContent(e,t){let n=this.elements.sections[e];n&&(n.querySelector(":scope > .inner > .content").innerHTML=t)}},c=class{worker;taskMap={};initWorker(){this.worker=new Worker(globalThis.TaskGenUrl),this.worker.onmessage=e=>{this.setupTask(e.data)}}genTask(e){let t=e.getAttribute("data-script-id");if(this.taskMap[t])return;let n=new g(e);this.taskMap[t]=n,e.setAttribute("data-generating","");let r={};r.scriptId=t,r.script=e.getAttribute("data-script"),r.statement=n.statement;let a={};n.getSectionNames().forEach(s=>{a[s]=n.getSectionContent(s)}),Object.keys(a).length>0&&(r.sections=a),this.worker||this.initWorker(),this.worker.postMessage(r)}setupTask(e){let t=this.taskMap[e.scriptId];t.statement=e.statement,e.sections&&Object.keys(e.sections).forEach(n=>{t.setSectionContent(n,e.sections[n])}),m(t.elements.task),t.elements.task.removeAttribute("data-generating"),delete this.taskMap[e.scriptId]}};var q=[h,f,b,k,T];function m(i){i&&q.forEach(e=>e(i))}globalThis.GenTaskManager=new c;return S(x);})();
